"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[533],{3274:function(e,s,l){l.r(s),l.d(s,{Drawer:function(){return o},DrawerOpener:function(){return c}});var t=l(3827),a=l(4090);let r="notification-drawer-001",n=(0,a.createContext)([]),i=()=>(0,a.useContext)(n),c=e=>(0,t.jsx)("label",{htmlFor:r,className:"cursor-pointer",children:e.children}),d=e=>{let s=i();return(0,t.jsxs)("div",{className:"drawer drawer-end",children:[(0,t.jsx)("input",{id:r,type:"checkbox",className:"drawer-toggle"}),(0,t.jsx)("div",{className:"drawer-content",children:e.children}),(0,t.jsxs)("div",{className:"drawer-side",children:[(0,t.jsx)("label",{htmlFor:r,"aria-label":"close sidebar",className:"drawer-overlay"}),(0,t.jsx)("ul",{className:"menu p-4 w-80 min-h-full bg-base-200 text-base-content",children:s.map((e,s)=>(0,t.jsx)("li",{children:e},s))})]})]})},o=e=>(0,t.jsxs)(n.Provider,{value:["test"],children:[e.children,(0,t.jsx)(d,{})]})},7244:function(e,s,l){l.d(s,{i:function(){return N}});var t=l(3827),a=l(4090),r=l(3167),n=l(9539),i=l.n(n),c=l(7861),d=l(625),o=l(8346);let u=e=>(0,t.jsx)(d.Z,{language:"javascript",style:o.Z,children:e.code});var m=l(5835),x=l(9517),h=l.n(x);let p="クリップボードにコピーしました。";function f(e){let[s,l]=(0,a.useState)(e.target);return(0,a.useEffect)(()=>{s===p&&setTimeout(()=>{l(e.target)},1e3)},[s,e.target]),(0,t.jsx)("div",{className:"tooltip tooltip-bottom","data-tip":s,children:(0,t.jsx)("button",{className:"btn whitespace-nowrap",onClick:()=>{l(p),h()(e.target)},children:e.text})})}var j=l(8246);let v=e=>(0,t.jsx)("td",{children:e.children}),N=e=>{let s=(0,j.useModalContext)(),l=e=>{if(null===e)return"null";switch(typeof e){case"object":if(e instanceof Date)return i()(e).format("YY/MM/DD");if(!("type"in e))return(0,t.jsx)("button",{className:"btn",onClick:()=>{s.open((0,t.jsx)(u,{code:JSON.stringify(e,null,2)}))},children:"JSON"});if("date"===e.type)return i()(e.value).format(e.format);return e.value;case"string":if(c.s7.test(e.trim()))return(0,t.jsx)(f,{text:"URL Data",target:e});if(e.length>=50)return(0,t.jsx)(f,{text:"長文テキスト",target:e});return e;case"undefined":return"undefined";case"function":return"NaN";case"boolean":return e?"true":"false";case"symbol":return"symbol";default:return e}},n=(0,a.useMemo)(()=>"simple"===e.type?{headers:e.head,records:e.target.map(e=>e.map(l))}:"object"===e.type?{headers:e.keyMap.map(e=>{let s=e.displayName||e.keyName;return"symbol"==typeof s?"symbol":s}),records:e.target.map(s=>e.keyMap.map(e=>{let t=s[e.keyName];return null==t?null:l(t)}))}:null,[e]),d=(0,m.l)([e]);if(null!=n)return(0,t.jsx)("div",{className:(0,r.Z)("w-full px-2 perfect-scrollbar z-0",{border:e.bordered}),ref:d.ref,children:(0,t.jsxs)("table",{className:"table table-pin-rows",children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:n.headers.map((e,s)=>(0,t.jsx)("th",{children:(0,t.jsx)("div",{className:"flex justify-between items-center",children:e})},s))})}),(0,t.jsx)("tbody",{children:n.records.map((e,s)=>(0,t.jsx)("tr",{children:e.map((e,s)=>(0,t.jsx)(v,{children:e},s))},s))})]})})}},5533:function(e,s,l){l.r(s),l.d(s,{BroadcastContent:function(){return q},Footer:function(){return Q}});var t=l(3827),a=l(8792),r=l(7907),n=l(3167),i=l(3748),c=l(4090),d=l(670),o=l(1863),u=l(5835);let m=e=>(0,t.jsxs)("div",{className:"stat",children:[null==e.icon?null:(0,t.jsx)("div",{className:"stat-figure",children:e.icon}),null==e.title?null:(0,t.jsx)("div",{className:"stat-title",children:e.title}),null==e.value?null:(0,t.jsx)("div",{className:"stat-value",children:(0,t.jsx)("span",{className:"",children:e.value})}),null==e.caption?null:(0,t.jsx)("div",{className:"stat-desc",children:e.caption})]});var x=l(8903);let h=e=>{let s=(0,d._o)(e.userData.id),l=(0,i.useEventSubContext)(),a=(0,c.useCallback)(()=>{confirm("スパムとして認識させますか？")&&s({isSpam:!0})},[e.userData]),{CHANNEL:r}=(0,o.yd)(e.userData.login);if(null!=l)return(0,t.jsxs)("li",{className:"flex gap-2",children:[(0,t.jsx)("div",{className:"whitespace-nowrap w-full",children:(0,t.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"link",children:e.userData.displayName||e.userData.login})}),(0,t.jsx)("div",{children:(0,t.jsx)("a",{className:"cursor-pointer font-black ",onClick:a,children:"x"})}),(0,t.jsx)("div",{className:"w-4",children:-1!==l.followers.findIndex(s=>s.userId===e.userData.id)?"☑":"☐"})]})},p=e=>{let s=(0,i.useEventSubContext)(),l=(0,c.useMemo)(()=>{if((null==s?void 0:s.chatUsers)!=null)return s.chatUsers.sort((e,s)=>Number(e.id||"")<Number(s.id||"")?1:-1)},[null==s?void 0:s.chatUsers]),a=(0,u.l)([null==s?void 0:s.chatUsers]);if(null!=l)switch(e.type){case"number":return(0,t.jsx)("div",{children:l.length});case"stat":return(0,t.jsx)(m,{title:(0,t.jsxs)("div",{className:"flex gap-2",children:["チャットユーザー数"," ",(0,t.jsx)("span",{className:"tooltip tooltip-bottom tooltip-info","data-tip":"`反映までには多少ラグが発生します。",children:x.U.INFORMATION})]}),value:"".concat(l.length,"人"),icon:x.U.COMMENT});case"list":return(0,t.jsx)("div",{className:(0,n.Z)("px-4 py-2 perfect-scrollbar"),ref:a.ref,children:(0,t.jsx)("ul",{children:l.filter(e=>e.id!==(null==s?void 0:s.me.id)).map(e=>(0,t.jsx)(h,{userData:e},e.id))})})}};var f=l(9539),j=l.n(f),v=l(8473),N=l(4687),g=l(7341),b=l(6639),w=l(8151),y=l(66);let k=e=>{let{type:s,color:l,image:a,message:r,header:i,footer:c,onClickAvater:d}=e,o=null==a?null:(0,t.jsx)("div",{className:"chat-image avatar cursor-pointer",onClick:d,children:(0,t.jsx)("div",{className:"w-10 rounded-full",children:(0,t.jsx)("img",{...a})})}),u=null==c?null:(0,t.jsx)("div",{className:"chat-footer",children:c}),m=null==i?null:(0,t.jsx)("div",{className:"chat-header",children:i});return(0,t.jsxs)("div",{className:(0,n.Z)("chat",s),children:[o,m,(0,t.jsx)("p",{className:(0,n.Z)("chat-bubble",l),children:r}),u]})},I=e=>Array(e).fill("　").join(" "),M=e=>(0,t.jsxs)("div",{className:"chat chat-end",children:[e.hasImage&&(0,t.jsx)("div",{className:"chat-image",children:(0,t.jsx)("div",{className:"w-10 h-10 rounded-full skeleton"})}),e.hasHeader&&(0,t.jsx)("div",{className:"chat-header skeleton",children:I(5)}),(0,t.jsx)("p",{className:"chat-bubble skeleton",children:I(10)}),e.hasFooter&&(0,t.jsx)("div",{className:"chat-footer skeleton",children:I(3)})]});var C=l(8246);let U=e=>{let[s,l]=c.useState("");return c.useEffect(()=>{w.db.users.where("id").equals(e.userId).first().then(e=>{null!=e&&l(e.metaComment||"")})},[e.userId]),(0,t.jsxs)("label",{className:"form-control",children:[(0,t.jsx)("div",{className:"label",children:(0,t.jsx)("span",{className:"label-text",children:"BIO"})}),(0,t.jsx)("textarea",{className:"textarea textarea-bordered leading-4",placeholder:"Bio",value:s,onChange:s=>{l(s.currentTarget.value),w.db.users.update(e.userId,{metaComment:s.currentTarget.value})}}),(0,t.jsxs)("div",{className:"label",children:[(0,t.jsx)("span",{className:"label-text-alt"}),(0,t.jsx)("span",{className:"label-text-alt",children:s.length})]})]})},D=e=>{let s=(0,d.Bo)(e.userId);if(null!=s)return(0,t.jsxs)("div",{className:"flex justify-center items-center gap-4",children:[(0,t.jsx)("div",{className:"chat-image avatar dropdown dropdown-end",children:(0,t.jsx)("div",{className:"w-10 rounded-full",tabIndex:0,role:"button",children:(0,t.jsx)("img",{alt:s.displayName,src:s.profileImageUrl})})}),(0,t.jsxs)("p",{className:"opacity-80 font-black pb-1",children:[(null==s?void 0:s.displayName)||(null==s?void 0:s.login),"が 「",e.title,"」 を交換しました。"]})]})},S=e=>{let s=e.type||"medium",l=(0,C.useShowUserInfoModal)(),a=(0,y.useUserContext)(),r=(0,b.yR)(()=>a.fetchUserById(e.userId),[e.userId]),n=c.useCallback(()=>{null!=r&&l.open(r.id)},[r]),i=(null==r?void 0:r.displayName)!=null&&(null==r?void 0:r.displayName)!==(null==r?void 0:r.login);if(null==r)return(0,t.jsx)(M,{hasFooter:!0,hasHeader:!0,hasImage:!0});if("chat-only"===s){let s=(0,t.jsx)("ul",{tabIndex:0,className:"dropdown-content z-[1] w-64 shadow bg-base-100 p-2",children:(0,t.jsx)("li",{children:(0,t.jsx)(U,{userId:e.userId})})});return(0,t.jsx)("div",{className:"chat chat-start",children:(0,t.jsxs)("div",{className:"dropdown dropdown-start",children:[e.message,s]})})}return(0,t.jsx)(k,{type:"chat-end",image:{src:r.profileImageUrl,alt:r.login},onClickAvater:n,message:e.message,header:i?(0,t.jsxs)("div",{className:"flex gap-1 items-end",children:[(0,t.jsx)("span",{className:"text-xs opacity-50",children:r.login}),(0,t.jsx)("span",{className:"text-sm",children:r.displayName})]}):r.login,footer:(0,t.jsx)("time",{className:"text-xs opacity-50",children:e.time})})};var E=l(7244);let A=()=>{let e=(0,N.hb)(),s=(0,c.useMemo)(()=>e.sort((e,s)=>Number(e.userId||"")<Number(s.userId||"")?1:-1).map(e=>{if("chat"===e.messageType)return{...e,comments:(0,t.jsx)(g.e,{fragments:e.fragments})}}).filter(v.h.notNull),[e]);return(0,t.jsx)(E.i,{type:"object",target:s,keyMap:[{keyName:"id"},{keyName:"userId",displayName:"ユーザーID"},{keyName:"comments",displayName:"コメント"}]})},T=()=>{let e=(0,d.fk)();return(0,t.jsx)(m,{icon:x.U.COMMENT,value:"".concat(e,"件"),title:"本日のコメント数"})},O=()=>{let e=(0,N.hb)(),s=(0,u.l)([e],{suppressScrollX:!0});return(0,t.jsx)("div",{className:(0,n.Z)("w-full px-4 py-2 bg-base-100 perfect-scrollbar"),ref:s.ref,children:(0,t.jsx)("ul",{className:"flex flex-col",children:e.map(e=>{if(null==e.timestamp||"atutomatic-reward"===e.messageType)return(0,t.jsx)(t.Fragment,{});if("reward"===e.messageType)return(0,t.jsx)("li",{children:(0,t.jsx)(D,{id:e.id,userId:e.userId||"",time:j()(e.timestamp).format("HH:mm:ss"),title:e.userTitle,input:e.userInput})},e.id);let s=new Date(e.timestamp),l=null==e.fragments||0==e.fragments.length?void 0:(0,t.jsx)(g.e,{fragments:e.fragments});return(0,t.jsx)("li",{children:(0,t.jsx)(S,{type:"mini",id:e.id,time:j()(s).format("HH:mm:ss"),message:l||e.message,userId:e.userId||""})},e.id)})})})},H=e=>{switch(e.type){case"list":return(0,t.jsx)(O,{});case"stat":return(0,t.jsx)(T,{});case"table":return(0,t.jsx)(A,{})}};var Y=l(3121),B=l(863);let Z=()=>{let[e,s]=(0,c.useState)({date:"0000/00/00",time:"00:00",daysOfWeek:"月"});return(0,B.Y)(()=>{let e=(0,Y.B)(new Date);s({date:e.format("YYYY/MM/DD"),time:e.format("HH:mm"),daysOfWeek:e.format("ddd")})},{interval:1e3,deps:[]}),(0,t.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[(0,t.jsxs)("div",{className:"flex justify-between w-full",children:[(0,t.jsx)("div",{className:"countdown text-xs",children:e.time}),(0,t.jsxs)("div",{className:"countdown text-xs",children:["(",e.daysOfWeek,")"]})]}),(0,t.jsx)("div",{className:"countdown text-xs",children:e.date})]})},F=e=>{let[s,l]=(0,c.useState)("00:00:00"),a=new Intl.NumberFormat("ja",{minimumIntegerDigits:2});return(0,c.useEffect)(()=>{if(null!=e.pause||null==e.startMilliSeconds)return;let s=e.startMilliSeconds,t=window.setInterval(()=>{let t=new Date(Date.now()-s),r=e.containsTimeZone?-t.getTimezoneOffset()/60:0;l("".concat(a.format((t.getUTCHours()+r+24)%24),":").concat(a.format(t.getUTCMinutes()),":").concat(a.format(t.getUTCSeconds())))},1e3);return()=>{window.clearInterval(t)}},[e.startMilliSeconds,e.pause]),(0,t.jsx)("span",{className:" text-xs",children:(0,t.jsx)("span",{children:s})})};var _=l(3274);let L=e=>{let s=(0,d.Bo)(e.userId);if(null!=s)return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:s.displayName||s.login}),(0,t.jsx)("div",{className:"avatar",children:(0,t.jsx)("div",{className:"w-12 rounded-full",children:(0,t.jsx)("img",{src:s.profileImageUrl,alt:s.id})})})]})},R=()=>{let e=(0,i.useEventSubContext)(),s=(0,c.useMemo)(()=>(null==e?void 0:e.followers.map(e=>e.userId))||[],[e]),l=(0,y.useGetUserMap)(s),a=(0,c.useMemo)(()=>(null==e?void 0:e.followers)==null?[]:e.followers.sort((e,s)=>e.followedAt<s.followedAt?1:-1),[null==e?void 0:e.followers]),r=(0,C.useShowUserInfoModal)(),n=(0,c.useMemo)(()=>null==a||null==l?null:{keyMap:[{keyName:"image",displayName:"アイコン"},{keyName:"name",displayName:"名前"},{keyName:"followedAt",displayName:"フォロー開始日"}],target:a.map(e=>{let s=l.get(e.userId);if(null!=s)return{name:{type:"jsx",value:(0,t.jsx)("p",{children:(0,t.jsx)("a",{className:"cursor-pointer",onClick:()=>{r.open(s.id)},children:s.displayName||s.login})})},image:{type:"jsx",value:(0,t.jsx)("div",{className:"avatar",children:(0,t.jsx)("div",{className:"w-7 rounded-full cursor-pointer",onClick:()=>{r.open(s.id)},children:(0,t.jsx)("img",{src:s.profileImageUrl})})})},followedAt:{type:"date",value:e.followedAt,format:"YYYY/MM/DD HH:mm (ddd)"}}}).filter(v.h.notNull)},[a,l]);if(null!=n)return(0,t.jsx)(E.i,{type:"object",...n})},z=e=>{let s=(0,i.useEventSubContext)();if(null!=s)switch(e.type){case"table":return(0,t.jsx)(R,{});case"list":return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"info"}),(0,t.jsx)("ul",{children:s.followers.map(e=>(0,t.jsxs)("li",{children:[(0,t.jsx)(L,{userId:e.userId}),(0,t.jsx)("p",{children:(0,Y.B)(e.followedAt).format("YYYY/MM/DD HH:mm:ss")})]},e.userId))})]});case"stat":return(0,t.jsx)(m,{title:"フォロワー数",value:"".concat(s.followers.length,"人"),icon:x.U.FOLLOW})}},G=()=>{var e;let s=(0,i.useEventSubContext)();return(0,t.jsx)(m,{icon:x.U.EYE,value:"".concat((null==s?void 0:null===(e=s.live)||void 0===e?void 0:e.viewerCount)||0,"人"),title:"ライブ視聴者数"})};var W=function(e){return(0,t.jsx)("svg",{className:e.className,xmlns:"http://www.w3.org/2000/svg",width:"21",height:"21",fill:"none",viewBox:"0 0 21 21",children:(0,t.jsx)("path",{stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",d:"M18.5 8.5v-5m0 0h-5m5 0l-7 7m-1-7h-5a2 2 0 00-2 2v10a2 2 0 002 2h11a2 2 0 002-2v-4"})})};let J=()=>{let e=(0,i.useEventSubContext)(),s=(0,d.bL)(),l=(0,c.useMemo)(()=>{if(null!=e&&null!=s)return s.get(e.me.id)},[e,s]),a=(0,c.useMemo)(()=>null==e?null:(0,o.yd)(e.me.channelName),[e]);return(0,t.jsxs)("div",{className:"dropdown dropdown-top",style:{lineHeight:0},children:[(0,t.jsx)("div",{className:"avatar",tabIndex:0,role:"button",children:(0,t.jsx)("div",{className:(0,n.Z)("w-12 h-12 rounded-full border border-primary",{skeleton:(null==l?void 0:l.profileImageUrl)==null}),children:(null==l?void 0:l.profileImageUrl)!=null?(0,t.jsx)("img",{src:l.profileImageUrl}):null})}),null==a?null:(0,t.jsxs)("ul",{className:"p-2 shadow menu dropdown-content z-[1] bg-base-100 text-base-content dasy-rounded w-52 border",tabIndex:0,children:[(0,t.jsx)("li",{children:(0,t.jsxs)("a",{className:"link flex gap-x-2",target:"_blank",href:a.CHANNEL,children:["チャンネルへ ",(0,t.jsx)(W,{className:"scale-90 origin-center"})]})}),(0,t.jsx)("li",{children:(0,t.jsxs)("a",{className:"link flex gap-x-2",target:"_blank",href:a.STREAM_MANAGER,children:["チャンネルマネージャーへ",(0,t.jsx)(W,{className:"scale-90 origin-center"})]})}),(0,t.jsx)("li",{onClick:()=>{(0,o.HB)(),location.reload()},children:(0,t.jsx)("a",{children:"ログアウト"})})]})]})},P=[{icon:x.U.BROADCAST,text:"ライブ",path:"/"},{icon:x.U.GAME,text:"ゲーム",path:"/games"},{icon:x.U.DATABASE,text:"集計データ",path:"/database"},{icon:x.U.GEAR,text:"設定",path:"/setting"}],q=()=>{if(null!=(0,i.useEventSubContext)())return(0,t.jsxs)("div",{className:"flex flex-col gap-2 h-full py-2",children:[(0,t.jsx)("div",{className:"h-fit px-2",children:(0,t.jsxs)("div",{className:"flex stats shadow mt-2",children:[(0,t.jsx)(p,{type:"stat"}),(0,t.jsx)(G,{}),(0,t.jsx)(z,{type:"stat"}),(0,t.jsx)(H,{type:"stat"})]})}),(0,t.jsx)("div",{className:"h-96 grow px-2",children:(0,t.jsxs)("div",{className:"flex w-full h-full gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("p",{className:"whitespace-nowrap px-4 py-2 font-black text-xs bg-base-300 text-base-content dasy-rounded",children:"チャットユーザ一覧"}),(0,t.jsx)(p,{type:"list"})]}),(0,t.jsxs)("div",{className:"grow flex flex-col",children:[(0,t.jsx)("p",{className:"whitespace-nowrap px-4 py-2 font-black text-xs bg-base-300 text-base-content dasy-rounded",children:"フォロワ一覧"}),(0,t.jsx)(z,{type:"table"})]}),(0,t.jsxs)("div",{className:"flex flex-col w-2/6",children:[(0,t.jsx)("p",{className:"whitespace-nowrap px-4 py-2 font-black text-xs bg-base-300 text-base-content dasy-rounded",children:"コメント一覧"}),(0,t.jsx)(H,{type:"list"})]})]})})]})},X=e=>{let s=e.active||!1,l=(0,n.Z)({"opacity-50":!s,"opacity-100":s},"transition-opacity transition-transform");return(0,t.jsxs)(a.default,{className:(0,n.Z)("flex flex-col items-center cursor-pointer h-full justify-between w-16 whitespace-nowrap",l),href:e.path,as:e.path,children:[(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("p",{className:"text-xs font-black ",children:e.text})]})},K=()=>{let e=(0,r.usePathname)();return(0,t.jsx)("nav",{className:"flex gap-4 grow items-end",children:P.map(s=>(0,t.jsx)(X,{...s,active:s.path===e},s.path))})},Q=()=>{var e,s;let l=(0,i.useEventSubContext)();if(null!=l)return(0,t.jsx)("footer",{className:"footer items-center bg-primary flex text-primary-content sticky bottom-0 h-fit mt-auto py-3 px-4",children:(0,t.jsxs)("div",{className:"flex gap-4 items-center grow",children:[(0,t.jsx)(J,{}),(0,t.jsx)(K,{}),(0,t.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("p",{className:"text-xs",children:"配信時間"}),(0,t.jsx)(F,{startMilliSeconds:null===(s=l.live)||void 0===s?void 0:null===(e=s.startedAt)||void 0===e?void 0:e.getTime()})]}),(0,t.jsx)("div",{children:(0,t.jsx)(Z,{})}),(0,t.jsx)("div",{children:(0,t.jsx)(_.DrawerOpener,{children:x.U.NOTIFICATION})})]})]})})}}}]);