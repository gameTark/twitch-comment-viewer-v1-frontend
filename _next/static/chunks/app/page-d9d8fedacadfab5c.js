(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{28137:function(e,l,s){Promise.resolve().then(s.bind(s,32668))},72037:function(e,l,s){"use strict";s.d(l,{k:function(){return a}});var t=s(57437);let a=e=>(0,t.jsxs)("div",{className:"stat",children:[null==e.icon?null:(0,t.jsx)("div",{className:"stat-figure",children:e.icon}),null==e.title?null:(0,t.jsx)("div",{className:"stat-title",children:e.title}),null==e.value?null:(0,t.jsx)("div",{className:"stat-value",children:(0,t.jsx)("span",{className:"",children:e.value})}),null==e.caption?null:(0,t.jsx)("div",{className:"stat-desc",children:e.caption})]})},32668:function(e,l,s){"use strict";s.d(l,{BroadcastContent:function(){return eh}});var t=s(57437),a=s(2265),n=s(95835),r=s(44839),i=s(19939),c=s(53897),d=s(91279),o=s(67687),u=s(23332);let x=e=>{let{type:l,color:s,image:a,imageNode:n,message:i,header:c,footer:d,onClickAvater:o}=e;return(0,t.jsxs)("div",{className:(0,r.Z)("chat",l),children:[null==(a||n)?null:(0,t.jsx)("div",{className:"chat-image avatar cursor-pointer",onClick:o,children:(0,t.jsx)("div",{className:"w-10 rounded-full border-2",children:n||(0,t.jsx)("img",{...a})})}),null==c?null:(0,t.jsx)("div",{className:"chat-header",children:c}),(0,t.jsx)("p",{className:(0,r.Z)("chat-bubble",s),children:i}),null==d?null:(0,t.jsx)("div",{className:"chat-footer",children:d})]})};var h=s(97383),m=s(91825),j=s(12853);let v=(0,a.createContext)(void 0),f=()=>(0,a.useContext)(v),p=()=>(0,d.yR)(async()=>{let e=await o.db.getMe();return null==e?[]:(await o.db.followers.where("channelId").equals(e.id).sortBy("followedAt")).reverse().filter(m.h.notDeleted).filter(e=>null==e.deletedAt)},[]),b=e=>{let{value:l,children:s}=e;return(0,t.jsx)(v.Provider,{value:l,children:s})},N={RecordProvider:e=>{let{children:l,...s}=e,a=p();return(0,t.jsx)("tbody",{...s,children:null==a?void 0:a.map(e=>(0,t.jsx)(b,{value:e,children:l},e.id))})},Provider:e=>{let{id:l,children:s}=e,a=(0,d.yR)(async()=>await o.db.followers.where("userId").equals(l).first(),[l]);return(0,t.jsx)(v.Provider,{value:a,children:s})},FollowedAt:(0,j.RY)(f,["followedAt"]),UserProvider:e=>{let l=f();return(0,t.jsx)(e.Povider,{id:null==l?void 0:l.userId,children:e.children})},Badge:e=>{let l=f();switch(e.type||"tag"){case"tag":if(null==l)return(0,t.jsx)("span",{className:"badge badge-info badge-sm opacity-30 select-none",children:"フォロワー"});return(0,t.jsx)("span",{className:"badge badge-info badge-sm select-none",children:"フォロワー"});case"icon":if(null==l)return(0,t.jsx)("span",{className:"opacity-0 select-none",children:"♡"});return(0,t.jsx)("span",{className:" text-accent select-none",children:"♥"})}},FollowerCount:e=>{let l=p();return(0,t.jsx)("span",{...e,children:(null==l?void 0:l.length)||0})}};var w=s(35166);let g=()=>{let e=(0,h.v)(),l=w.n.useUser();return(0,a.useCallback)(s=>{let a=s||(null==l?void 0:l.id);null!=a&&e.open((0,t.jsx)(y,{userId:a}))},[l])},y=e=>(0,t.jsx)(w.n.Provider,{id:e.userId,children:(0,t.jsx)(N.Provider,{id:e.userId,children:(0,t.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,t.jsxs)("div",{className:"flex gap-6 content-stretch bg-cover",children:[(0,t.jsx)("div",{className:"chat-image avatar dropdown dropdown-end select-none",children:(0,t.jsx)("div",{className:"w-40 rounded-full border",children:(0,t.jsx)(w.n.ProfileImage,{})})}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("p",{children:["名前: ",(0,t.jsx)(w.n.Name,{})]}),(0,t.jsxs)("p",{children:["ID: ",(0,t.jsx)(w.n.Id,{})]}),(0,t.jsxs)("p",{children:["フォロワー数: ",(0,t.jsx)(w.n.FollowerCount,{})]}),(0,t.jsxs)("p",{children:["フォロー開始日: ",(0,t.jsx)(N.FollowedAt,{format:"YYYY/MM/DD"})]}),(0,t.jsx)("div",{className:"mt-auto select-none",children:(0,t.jsx)(N.FollowedAt,{})})]})]}),(0,t.jsx)("div",{children:(0,t.jsx)("p",{children:(0,t.jsx)(w.n.TwitchLink,{})})}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"font-black",children:"BIO"}),(0,t.jsx)(w.n.EditableMetaComment,{})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("p",{className:"font-black",children:"コメント一覧"}),(0,t.jsx)("div",{className:"h-56 border rounded-md",children:(0,t.jsx)(Q,{userId:e.userId})})]})]})})});var k=s(74668),C=s(51416),I=s(82876);let _=(0,a.createContext)(void 0),P=()=>(0,a.useContext)(_),R=(0,j.RY)(P,["timestamp"]),Y=((0,j.kQ)(P,["bits"]),(0,a.createContext)(void 0)),q=()=>(0,a.useContext)(Y),A=((0,j.kQ)(q,["userInput"]),(0,j.kQ)(q,["userTitle"])),B=(0,a.createContext)(void 0),S=()=>(0,a.useContext)(B),E=e=>{let{children:l,data:s,...a}=e;return(0,t.jsx)("ul",{...a,children:null==s?void 0:s.map(e=>(0,t.jsx)(_.Provider,{value:e,children:l},e.id))})},F=e=>(0,t.jsx)("li",{...e}),T=e=>{let l=P();return(0,t.jsx)(w.n.Provider,{id:null==l?void 0:l.userId,children:e.children})},U=e=>{let l=P();return(null==l?void 0:l.messageType)==="reward"?(0,t.jsx)(Y.Provider,{value:l,children:e.children}):null},L=e=>{let l=P();return(null==l?void 0:l.messageType)==="chat"?(0,t.jsx)(B.Provider,{value:l,children:e.children}):null},M=e=>{let l=S();return(0,t.jsx)("span",{...e,children:null==l?void 0:l.fragments.map((e,l)=>{switch(e.type){case"emote":return(0,t.jsx)("img",{src:(0,I.jp)(e.emote.id),alt:e.text,className:"inline mx-1"},l);case"text":return(0,t.jsx)("span",{className:"break-all",dangerouslySetInnerHTML:{__html:(0,C.G9)(k.Y(e.text))}},l);case"mention":return(0,t.jsx)("a",{className:"link link-info",target:"__blank",href:(0,I.yd)(e.mention.user_login).CHANNEL,children:e.text},l)}})})},Z=()=>{let e=g();return(0,t.jsxs)(F,{className:"w-full px-2",children:[(0,t.jsx)(L,{children:(0,t.jsx)(x,{type:"chat-end",imageNode:(0,t.jsx)(w.n.ProfileImage,{onClick:()=>e(),tabIndex:0}),header:(0,t.jsx)(w.n.Name,{className:"inline-block mb-1",onClick:()=>e(),tabIndex:0}),message:(0,t.jsx)(M,{}),footer:(0,t.jsx)(R,{className:"inline-block mt-1",format:"hh:mm:ss"})})}),(0,t.jsx)(U,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,t.jsx)(w.n.ProfileImage,{className:"rounded-full w-10 border-2 overflow-hidden cursor-pointer",tabIndex:0,onClick:()=>e()}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(w.n.Name,{className:"font-bold cursor-pointer",tabIndex:0,onClick:()=>e()}),(0,t.jsx)("span",{children:"が"}),(0,t.jsx)(A,{className:"font-bold"}),(0,t.jsx)("span",{children:"と交換しました。"})]})]})})]})},D=()=>(0,t.jsxs)(F,{className:"w-full border-b-2 last:border-0 pb-2",children:[(0,t.jsx)(L,{children:(0,t.jsx)(M,{})}),(0,t.jsx)(U,{children:(0,t.jsx)(A,{className:"font-bold"})})]}),O=()=>(0,t.jsxs)(F,{className:"w-full border-b-2 px-2 last:border-0 pb-2 flex items-center gap-3",children:[(0,t.jsx)(w.n.Name,{className:" inline-block text-xs font-bold min-w-32"}),(0,t.jsxs)("span",{className:"inline-block grow",children:[(0,t.jsx)(L,{children:(0,t.jsx)(M,{})}),(0,t.jsx)(U,{children:(0,t.jsxs)("span",{className:"inline-flex gap-2 items-center",children:[(0,t.jsx)("span",{className:" inline-block text-sm font-bold",children:"リワード交換"}),(0,t.jsx)(A,{className:" text-info font-black"})]})})]}),(0,t.jsx)(R,{format:"hh:mm:ss",className:"text-xs opacity-70"})]}),X=e=>{let l=(0,d.yR)(async()=>await z(e.query).reverse().sortBy("timestamp"),[e.query]),s=(0,a.useMemo)(()=>{switch(e.type){case"viewewr":break;case"flat":return(0,t.jsx)(D,{});case"mini":return(0,t.jsx)(O,{})}return(0,t.jsx)(Z,{})},[e.type]);return(0,t.jsx)(i.X,{className:"h-full",children:(0,t.jsx)(E,{data:l||[],className:"flex flex-col gap-2 py-8",children:(0,t.jsx)(T,{children:s})})})},Q=e=>{var l,s,a,n;let r=(0,o.X1)(z({type:"userId",userId:e.userId}),{pageNo:0,pageSize:20},[e.userId]);return(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsx)(i.X,{children:(0,t.jsx)(E,{data:(null===(l=r.value)||void 0===l?void 0:l.target)||[],className:"flex flex-col gap-2 py-6 px-2",children:(0,t.jsx)(D,{})})}),(0,t.jsxs)("div",{className:"flex justify-between border-t-2 items-center select-none",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("button",{className:"btn btn-ghost btn-xs",onClick:r.prev,disabled:!(null===(s=r.value)||void 0===s?void 0:s.hasPrev),children:"prev"}),(0,t.jsx)("p",{children:"\xa0"}),(0,t.jsx)("button",{className:"btn btn-ghost btn-xs",onClick:r.next,disabled:!(null===(a=r.value)||void 0===a?void 0:a.hasNext),children:"next"})]}),(0,t.jsxs)("div",{className:"px-2 py-1 text-right",children:["総コメント数:",null===(n=r.value)||void 0===n?void 0:n.count]})]})]})},z=e=>{switch(e.type){case"timestamp":{let l={from:Number(e.from||(0,u.B)(new Date).subtract(10,"day").toDate()),to:Number(e.to||(0,u.B)(new Date).add(10,"day").toDate())},s={where:"timestamp",from:l.from,to:l.to},t=o.db.actions.where(s.where).between(s.from,s.to);if(null==e.limit)return t;return t.limit(e.limit)}case"userId":{let l=o.db.actions.where("userId").equals(e.userId).reverse();if(null==e.limit)return l;return l.limit(e.limit)}default:throw Error("")}};var K=s(8913),G=s(72037),H=s(11581);let J=()=>{let e=g(),l=w.n.useUpdateUser(),s=(0,K.R)(),n=(0,a.useCallback)(()=>{s.open({title:"スパムとして認識させますか？",onSuccess:()=>{l({isSpam:!0})}})},[]);return(0,t.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,t.jsx)("span",{className:" inline-block w-full whitespace-nowrap text-xs",children:(0,t.jsx)(w.n.Name,{className:" cursor-pointer",onClick:()=>e()})}),(0,t.jsx)(N.Badge,{type:"icon"}),(0,t.jsx)("span",{className:"cursor-pointer",onClick:n,children:(0,t.jsx)(H.U.CROSS.SIZE,{size:16})})]})},$=e=>{let l=(0,d.yR)(async()=>{let e=await o.db.getChatters(),l=await o.db.getMe();if(null!=l&&null!=e)return e.users.filter(e=>e!==l.id)},[]);switch(e.type){case"number":return(0,t.jsx)("div",{children:(null==l?void 0:l.length)||0});case"stat":return(0,t.jsx)(G.k,{title:(0,t.jsx)("div",{className:"flex gap-2",children:"チャットユーザー数"}),value:"".concat((null==l?void 0:l.length)||0,"人")});case"list":return(0,t.jsx)(i.X,{className:(0,r.Z)("px-1 py-2"),children:(0,t.jsx)("ul",{className:"flex flex-col gap-1",children:null==l?void 0:l.map(e=>(0,t.jsx)(N.Provider,{id:e,children:(0,t.jsx)(w.n.Provider,{id:e,children:(0,t.jsx)(J,{})})},e))})})}},V=()=>{let e=g();return(0,t.jsxs)("tr",{className:"h-16 cursor-pointer select-none",onClick:()=>e(),tabIndex:0,children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:"flex justify-center items-center",children:(0,t.jsx)(w.n.ProfileImage,{className:"rounded-full overflow-hidden w-10 border-2"})})}),(0,t.jsx)("td",{children:(0,t.jsx)(w.n.Name,{})}),(0,t.jsx)("td",{children:(0,t.jsx)(N.FollowedAt,{format:"YYYY/MM/DD hh:mm:ss",className:"whitespace-nowrap"})})]})},W=()=>(0,t.jsx)(G.k,{title:"フォロワー数 ",value:(0,t.jsxs)("span",{children:[(0,t.jsx)(N.FollowerCount,{}),"人"]})});function ee(){return(0,t.jsx)(i.X,{className:"w-full h-full",children:(0,t.jsxs)("table",{className:" table table-pin-rows z-0 table-xs",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"w-16 text-center",children:"画像"}),(0,t.jsx)("th",{className:"",children:"名前"}),(0,t.jsx)("th",{className:"w-36 text-center",children:"フォロー日"})]})}),(0,t.jsx)(N.RecordProvider,{children:(0,t.jsx)(N.UserProvider,{Povider:w.n.Provider,children:(0,t.jsx)(V,{})})})]})})}let el=()=>{let e=(0,d.yR)(()=>o.db.getLive(),[]);return(0,t.jsx)(G.k,{value:"".concat((null==e?void 0:e.viewCount)||0,"人"),title:"ライブ視聴者数"})};var es=s(67688),et=s(55355);let ea=()=>(0,et.a)({queryKey:["me_query"],queryFn:async()=>await o.db.getMe()}),en=()=>{var e,l;let s=ea();return(0,et.a)({queryKey:["information",null===(e=s.data)||void 0===e?void 0:e.id],queryFn:async()=>{var e,l;if((null===(e=s.data)||void 0===e?void 0:e.id)==null)return;let t=await (0,I.iS)({broadcaster_id:null===(l=s.data)||void 0===l?void 0:l.id});return(0,es.Bb)(...t.data)[0]},enabled:(null===(l=s.data)||void 0===l?void 0:l.id)!=null})},er=()=>{var e;let l=ea();return(0,a.useCallback)(async e=>{var s;if((null===(s=l.data)||void 0===s?void 0:s.id)!=null)return await (0,I.Xh)({id:{broadcaster_id:l.data.id},patch:{broadcaster_language:e.language,content_classification_labels:e.classificationLabels,tags:e.tags,title:e.broadcastTitle,game_id:e.gameId,is_branded_content:e.isBrandedContent}})},[null===(e=l.data)||void 0===e?void 0:e.id])};var ei=s(51938);let ec=()=>(0,t.jsxs)("div",{className:"flex stats",children:[(0,t.jsx)($,{type:"stat"}),(0,t.jsx)(el,{}),(0,t.jsx)(W,{})]}),ed=()=>(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsx)("p",{className:"whitespace-nowrap px-4 py-2 font-black text-xs bg-base-300 text-base-content dasy-rounded text-center",children:"チャットユーザ一覧"}),(0,t.jsx)($,{type:"list"})]}),eo=()=>{let e=en(),l=er(),s=(0,a.useCallback)(function(){for(var s=arguments.length,t=Array(s),a=0;a<s;a++)t[a]=arguments[a];l(...t).then(()=>{e.refetch()})},[e,l]);return((0,ei.Y)(()=>{e.isSuccess&&e.refetch()},{deps:[],interval:1e3}),e.isSuccess)?(0,t.jsx)(c.ZP,{value:e.data,onCommit:s}):(0,t.jsx)(t.Fragment,{})},eu=()=>{let[e,l]=(0,a.useState)(0);return(0,t.jsxs)(n.v0,{className:"flex flex-col h-full gap-4",selectedIndex:e,onChange:l,children:[(0,t.jsxs)(n.td,{className:" grow-0 tablist tabs-bordered w-full select-none",children:[(0,t.jsx)(n.OK,{as:"a",className:e=>(0,r.Z)("tab",{"tab-active":e.selected}),children:"フォロワ一覧"}),(0,t.jsx)(n.OK,{as:"a",className:e=>(0,r.Z)("tab",{"tab-active":e.selected}),children:"配信編集"}),(0,t.jsx)(n.OK,{as:"a",className:e=>(0,r.Z)("tab",{"tab-active":e.selected}),children:"配信テンプレート"})]}),(0,t.jsxs)(n.nP,{className:"relative grow overflow-hidden",children:[(0,t.jsx)(n.x4,{className:"flex w-full h-full",children:(0,t.jsx)(ee,{})}),(0,t.jsx)(n.x4,{className:"flex w-full h-full",children:(0,t.jsx)(eo,{})}),(0,t.jsx)(n.x4,{className:"flex w-full h-full",children:(0,t.jsx)(i.X,{children:(0,t.jsx)(c.J3,{})})})]})]})},ex=()=>{let[e,l]=(0,a.useState)("viewewr");return(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"whitespace-nowrap px-4 py-2 font-black text-xs bg-base-300 text-base-content dasy-rounded flex gap-5 items-center justify-between",children:["コメント一覧",(0,t.jsxs)("div",{className:"flex gap-2 items-center select-none",children:[(0,t.jsx)("span",{children:"表示タイプ"}),(0,t.jsxs)("select",{value:e,className:" cursor-pointer select select-xs select-bordered",onChange:e=>l(e.currentTarget.value),children:[(0,t.jsx)("option",{value:"viewewr",children:"Line風"}),(0,t.jsx)("option",{value:"mini",children:"小さめ"}),(0,t.jsx)("option",{value:"flat",children:"最小限"})]})]})]}),(0,t.jsx)(X,{type:e,query:{type:"timestamp",limit:500}})]})},eh=()=>(0,t.jsxs)("div",{className:"grid grid-rows-[max-content_minmax(0,1fr)] grid-cols-[200px_repeat(4,_minmax(0,_1fr))] h-full gap-4 p-2",children:[(0,t.jsx)("div",{className:"col-span-5 row-span-1",children:(0,t.jsx)(ec,{})}),(0,t.jsx)("div",{className:"row-start-2 col-span-1",children:(0,t.jsx)(ed,{})}),(0,t.jsx)("div",{className:"row-start-2 col-start-2 col-span-2",children:(0,t.jsx)(eu,{})}),(0,t.jsx)("div",{className:" row-start-2 col-start-4 col-span-2",children:(0,t.jsx)(ex,{})})]})},35166:function(e,l,s){"use strict";s.d(l,{n:function(){return C}});var t=s(57437),a=s(2265),n=s(91279),r=s(53731),i=s(59151),c=s(82876),d=s(87722);class o extends d.K{async batchLoad(e){return await (0,i.Rf)(e)}}var u=s(62022),x=s(11581),h=s(12853);let m=(0,a.createContext)(null),j=()=>(0,a.useContext)(m),v=new o,f=(0,h.kQ)(j,["displayName","login"],{children:"........."}),p=(0,h.kQ)(j,["id"],{children:"........."}),b=(0,h.kQ)(j,["description"],{children:"........."}),N=(0,h.kQ)(j,["metaComment"],{children:"........."}),w=(0,h.RY)(j,["createdAt"],{children:"...."}),g=(0,h.RY)(j,["updateAt"],{children:"...."}),y=(0,h.uB)(j,{src:["profileImageUrl"],alt:["login"]},r.Y_.PROFILE_404,{className:"inline-block aspect-square select-none"}),k=(0,h.uB)(j,{src:["offlineImageUrl"],alt:["login"]},r.Y_.NONE,{className:"inline-block aspect-square select-none"}),C={Provider:e=>{let l=(0,n.yR)(async()=>{if(null!=e.id)return await v.load(e.id)},[e.id]);return(0,t.jsx)(m.Provider,{value:l,children:e.children})},Id:p,useUser:j,useUpdateUser:()=>{let e=j();return(0,i._o)(null==e?void 0:e.id)},Name:f,ProfileImage:y,Description:b,UpdateAt:g,CreatedAt:w,MetaComment:N,EditableMetaComment:e=>{let l=j(),s=(0,a.useRef)(null),[n,r]=(0,a.useState)(""),c=(0,i._o)(null==l?void 0:l.id);(0,a.useEffect)(()=>{null!=l&&null!=s.current&&(r(l.metaComment||""),s.current.value=l.metaComment||"")},[null==l?void 0:l.id]);let d=(0,a.useCallback)(l=>{r(l.currentTarget.value),c({metaComment:l.currentTarget.value}),e.onChange&&e.onChange(l)},[]);return(0,t.jsx)("textarea",{className:"textarea textarea-bordered leading-4",placeholder:"Bio",rows:6,...e,onChange:d,defaultValue:n,ref:s})},OfflineImage:k,FollowerCount:()=>{let e=j(),l=(0,u.Gq)(async()=>{if((null==e?void 0:e.id)!=null)return(await (0,c.ZY)({broadcaster_id:e.id})).total||0},[null==e?void 0:e.id]);return(0,t.jsx)("span",{children:null!=l?l:"..."})},TwitchLink:e=>{let l=j();if(null!=l)return(0,t.jsxs)("a",{className:"link link-info flex gap-1 py-2 items-center",...e,target:"__blank",href:"https://www.twitch.tv/".concat(l.login),children:["Twitch ",x.U.EXTERNAL]})}}},51416:function(e,l,s){"use strict";s.d(l,{CB:function(){return r},G9:function(){return a},Pb:function(){return n}});let t=/[(http(s)?):\/\/(www\.)?a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/,a=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{start:'<a class="link link-info" href="$&" target="__blank">',end:"</a>"};return e.replace(t,"".concat(l.start,"$&").concat(l.end))},n=e=>{try{return JSON.parse(e),!0}catch(e){return!1}},r=e=>{try{return new URL(e),!0}catch(e){return!1}}}},function(e){e.O(0,[214,22,322,14,336,857,433,564,971,23,744],function(){return e(e.s=28137)}),_N_E=e.O()}]);