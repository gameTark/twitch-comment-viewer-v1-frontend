(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[423],{9943:function(e,l,a){Promise.resolve().then(a.bind(a,9349))},9349:function(e,l,a){"use strict";a.d(l,{default:function(){return M}});var s=a(7437),n=a(2265),t=a(1279),c=a(7687),r=a(9151),i=a(3315),u=a(1825);let d=e=>{let l=(0,n.useCallback)(()=>{null!=e.onClick&&e.onClick()},[e.onClick]);return(0,s.jsx)("div",{className:" w-full h-full flex items-center justify-center  shadow-xl rounded-box border-2 border-base-content  bg-base-content bg-opacity-40 transition  cursor-pointer  opacity-50 hover:opacity-100 ",tabIndex:0,onClick:l,children:(0,s.jsx)("div",{className:"h-12 w-12 rounded-full bg-base-100 text-base-content flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-4xl select-none",children:"+"})})})};var o=a(7383);let x=e=>(0,s.jsxs)("div",{className:"flex flex-col gap-10 px-8 py-4",children:[(0,s.jsx)("p",{className:"text-large text-center",children:e.title}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)("button",{className:"btn btn-error text-base-content",onClick:e.onFail,children:e.failText||"いいえ"}),(0,s.jsx)("button",{className:"btn btn-success",onClick:e.onSuccess,children:e.successText||"はい"})]})]}),h=()=>{let e=(0,o.v)();return{open:(0,n.useCallback)(l=>{let{onSuccess:a,onFail:n,...t}=l;e.open((0,s.jsx)(x,{...t,onFail:()=>{e.close(),null!=n&&n()},onSuccess:()=>{e.close(),null!=a&&a()}}))},[]),close:(0,n.useCallback)(()=>{e.close()},[])}};var m=a(3731),f=a(5032),b=a(1581);let p=e=>{let l=(0,n.useRef)(null),a=(0,n.useRef)(e.value||""),[t,c]=(0,n.useState)("");(0,n.useEffect)(()=>{a.current=e.value},[e.value]);let r=(0,n.useCallback)(e=>{null!=l.current&&(l.current.value=e,l.current.dispatchEvent(new Event("input",{bubbles:!0})))},[]),i=(0,n.useCallback)(e=>{let l=e.trim();if(""===l)return;let s=a.current.split(",");if(s.includes(l))return;let n=[...s,...l.split(",").map(e=>e.trim()).filter(e=>""!==e)].join(",");return c(""),r(n),n},[r]),u=(0,n.useCallback)(e=>{if(null==e){let e=a.current.split(",");r(e.slice(0,e.length-1).join(","));return}let l=a.current.split(",").filter(l=>l!==e).join(",");return r(l),l},[r]),d=(0,n.useCallback)(e=>{c(e.currentTarget.value)},[]),o=(0,n.useCallback)(e=>{u(e.currentTarget.value)},[]),x=(0,n.useCallback)(e=>{if(e.key===m.sd.ENTER){e.preventDefault(),e.stopPropagation(),i(e.currentTarget.value);return}},[]),h=(0,n.useMemo)(()=>e.value.split(",").filter(e=>""!==e),[e.value]);return(0,s.jsxs)("div",{className:"inline-flex flex-col gap-2",children:[(0,s.jsxs)("span",{className:"inline-flex gap-2",children:[(0,s.jsx)("input",{className:"input input-bordered w-64",type:"text",onKeyDown:x,onChange:d,value:t}),(0,s.jsx)("button",{className:"btn",onClick:()=>{i(t)},children:"追加"})]}),(0,s.jsx)("ul",{className:"flex gap-1 select-none flex-wrap",children:h.map(e=>(0,s.jsx)("li",{children:(0,s.jsx)(f.d,{size:"badge-lg",type:"badge-ghost",children:(0,s.jsxs)("span",{className:"flex items-center gap-1 whitespace-nowrap",children:[e,(0,s.jsxs)("label",{className:"cursor-pointer",children:[(0,s.jsx)("input",{type:"button",className:"hidden",value:e,onClick:o}),(0,s.jsx)(b.U.CROSS.SIZE,{size:15})]})]})})},e))}),(0,s.jsx)("input",{ref:l,name:e.name,type:"hidden",onInput:e.onChange})]})};var g=a(4839);let j=e=>{let l=(0,n.useMemo)(()=>{switch(e.size){case"xs":return"checkbox-xs";case"sm":return"checkbox-sm";case"md":return"checkbox-md";case"lg":return"checkbox-lg"}},[]),a=(0,n.useMemo)(()=>{switch(e.color){case"accent":return"checkbox-accent";case"error":return"checkbox-error";case"info":return"checkbox-info";case"primary":return"checkbox-primary";case"secondary":return"checkbox-secondary";case"success":return"checkbox-success";case"warning":return"checkbox-warning"}},[]);return(0,s.jsx)("div",{className:"form-control",children:(0,s.jsxs)("label",{className:"label cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",name:e.name,value:e.value,onChange:e.onChange,className:(0,g.Z)("checkbox",l,a),disabled:e.disabled,checked:e.chekced,defaultChecked:e.defaultChecked}),(0,s.jsx)("p",{className:"label-text px-4 text-left w-full",children:e.label})]})})},v=e=>{let l=(0,n.useMemo)(()=>{switch(e.size){case"xs":return"select-xs";case"sm":return"select-sm";case"md":return"select-md";case"lg":return"select-lg"}},[e.size]),a=(0,n.useMemo)(()=>{switch(e.color){case"accent":return"select-accent";case"error":return"select-error";case"info":return"select-info";case"primary":return"select-primary";case"secondary":return"select-secondary";case"success":return"select-success";case"warning":return"select-warning";case"ghost":return"select-ghost"}},[e.color]),t=(0,n.useMemo)(()=>{if(e.bordered)return"select-bordered"},[e.bordered]);return(0,s.jsx)("select",{className:(0,g.Z)("select w-full max-w-xs",a,l,t),disabled:e.disabled,name:e.name,onChange:e.onChange,children:e.children})};var N=a(1789);let C={twitchImage:{parseImage:e=>l=>e.replace("{width}",l.width.toString()).replace("{height}",l.height.toString())}};var k=a(2022),w=a(2646);let y=e=>{let l=(0,N.j)(),a=(0,k.Gq)(async()=>{if(null!=e.id)return await l.fetchById(e.id)},[e]),t=(0,n.useMemo)(()=>{if(null!=a)return C.twitchImage.parseImage(a.box_art_url)({width:300,height:400})},[a]),c=null==e.id,r=null==a;switch(e.type){case"item":return(0,s.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("div",{className:"avatar placeholder",children:c?(0,s.jsx)("div",{className:"w-16 dasy-rounded bg-neutral text-neutral-content",children:(0,s.jsx)("span",{className:"text-3xl",children:"G"})}):(0,s.jsx)("div",{className:"w-16 dasy-rounded",children:r?(0,s.jsx)("div",{className:"skeleton w-full h-full"}):(0,s.jsx)("img",{src:t,alt:a.name,width:80})})}),c?(0,s.jsx)("p",{className:"font-black",children:"ゲーム未選択"}):r?(0,s.jsx)("p",{className:"font-black skeleton w-full",children:"\xa0"}):(0,s.jsx)("p",{className:"font-black",children:a.name})]});case"card":if(null==e.id)return(0,s.jsx)("div",{});return(0,s.jsxs)("div",{className:"card w-full h-full bg-base-100 shadow-xl image-full select-none cursor-pointer",children:[r?(0,s.jsx)("div",{className:"f-hull w-full aspect-square"}):(0,s.jsx)("figure",{children:(0,s.jsx)("img",{src:t,alt:a.name,className:"w-full object-cover aspect-square"})}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h2",{className:"card-title",children:r?(0,s.jsx)("div",{className:"skeleton w-full",children:"\xa0"}):a.name}),r?(0,s.jsx)("div",{className:"skeleton w-full h-full",children:"\xa0"}):e.body,null!=e.actions?(0,s.jsx)("div",{className:"card-actions",children:e.actions}):null]})]})}},T=e=>{let l=(0,n.useRef)(null),a=(0,o.v)(),t=(0,n.useCallback)(s=>{a.close(),null!=e.onChange&&null!=l.current&&(l.current.value=s,l.current.dispatchEvent(new Event("input",{bubbles:!0})))},[a,e.onChange]),c=(0,n.useCallback)(()=>{a.open((0,s.jsx)(I,{onClick:t}))},[a]);return(0,s.jsxs)("div",{className:"   inline-flex   cursor-pointer   items-center   gap-4   border   dasy-rounded   p-2   ",onClick:c,children:[(0,s.jsx)("input",{type:"hidden",onInput:e.onChange,ref:l,name:e.name}),(0,s.jsx)(y,{id:e.value,type:"item"}),(0,s.jsx)("div",{className:"text-info",children:b.U.SEARCH})]})},I=e=>{let[l,a]=(0,k.Gl)(),[t,c]=(0,n.useState)(null),r=(0,n.useCallback)(l=>{if(null!=e.onClick){if(null==l.currentTarget.dataset.game)throw Error("not found game");e.onClick(l.currentTarget.dataset.game)}},[e.onClick]),u=(0,k.Nr)(500,async e=>{if(""===e||null==e)return null;c(await (0,i.sT)({query:e}))},[]);(0,n.useEffect)(()=>{u(l)},[l]);let d=(0,w.l)([t]);return(0,s.jsx)("div",{className:"h-96",children:(0,s.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,s.jsx)("input",{type:"text",placeholder:"Type here",className:"input input-bordered w-full max-w-xs",value:l,onChange:a}),(0,s.jsx)("div",{className:(0,g.Z)("w-full border dasy-rounded h-80 perfect-scrollbar bg-base-100"),ref:d.ref,children:null!=t?(0,s.jsx)("ul",{className:"flex flex-col gap-2 menu",children:t.map(e=>(0,s.jsx)("li",{"data-game":e.id,onClick:r,tabIndex:0,children:(0,s.jsx)(y,{id:e.id,type:"item"})},e.id))}):null})]})})};function E(e){let{onEdit:l,onApply:a,onDelete:t,...c}=e,i=(0,n.useCallback)(()=>{null!=l&&l({...c})},[]),u=(0,n.useCallback)(()=>{null!=a&&a({...c})},[]),d=(0,n.useCallback)(()=>{null!=t&&t({...c})},[]),o=(0,n.useCallback)(e=>{if(null==c.id)throw Error("not found props id");(0,r.Id)(c.id,{favorite:e.currentTarget.checked})},[]);return(0,s.jsxs)("div",{className:"relative z-0 h-full",children:[(0,s.jsxs)("div",{className:"   absolute   flex   flex-col   gap-4   justify-center   items-center   px-10   cursor-pointer   rounded-box      top-0   left-0      w-full   h-full      bg-base-content   bg-opacity-70   opacity-0   hover:opacity-100   transition      z-40   ",children:[(0,s.jsx)("button",{className:"btn btn-outline btn-success w-full",onClick:u,children:"配信に適用"}),(0,s.jsx)("button",{className:"btn btn-outline btn-info w-full",onClick:i,children:"編集"}),(0,s.jsx)("button",{className:"btn btn-outline btn-error w-full",onClick:d,children:"削除"})]}),(0,s.jsx)(y,{id:c.gameId,type:"card",body:(0,s.jsxs)("div",{className:"flex flex-col gap-4 h-full",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("p",{className:"text-caption",children:"配信タイトル"}),(0,s.jsx)("p",{children:c.broadcastTitle})]}),(0,s.jsx)("p",{className:"grow h-full",children:c.isBrandedContent?"ブランドコンテンツ":null}),(0,s.jsx)("div",{className:"flex gap-2 flex-wrap justify-end",children:c.tags.map(e=>(0,s.jsx)(f.d,{size:"badge-sm",children:e},e))})]})}),(0,s.jsx)("div",{className:"   absolute   top-0   right-0   z-50   bg-red   pt-1   pr-2   opacity-100   select-none   ",children:(0,s.jsx)("input",{type:"checkbox",defaultChecked:c.favorite,className:"   text-2xl   text-warning   before:content-['☆']   checked:before:content-['★']   cursor-pointer   appearance-none    ",onInput:o})})]})}function L(){let[e,l]=(0,n.useState)(S),a=(0,t.yR)(()=>c.db.getMe(),[]),[o,x]=(0,n.useState)("viewer"),m=h(),f=(0,n.useCallback)(e=>{l({...e})},[]),b=(0,n.useCallback)(e=>{l(e||{...S}),x("edit")},[]),p=(0,n.useCallback)(()=>{l({...S}),x("viewer")},[]),g=(0,n.useCallback)(e=>{m.open({title:"削除しますか？",onSuccess:()=>{null!=e.id&&(0,r.uM)([e.id])}})},[]),j=(0,n.useCallback)(e=>{let l=null==a?void 0:a.id;null!=l&&m.open({title:"配信に適用しますか？",onSuccess:()=>(0,i.Xh)({id:{broadcaster_id:l},patch:{game_id:e.gameId,broadcaster_language:e.language,title:e.broadcastTitle,tags:e.tags,content_classification_labels:e.classificationLabels,is_branded_content:e.isBrandedContent}}).then(()=>{m.close()})})},[a]),v=(0,t.yR)(async()=>(await (0,r.oV)()).filter(u.h.notNull),[]),N=(0,t.yR)(async()=>(await (0,r.oV)({type:"favorite",value:!0})).filter(u.h.notNull),[]);return"edit"===o?(0,s.jsx)("div",{className:"flex justify-center px-20 pt-10",children:(0,s.jsx)(B,{value:e,onChange:f,onCommit:e=>{null!=e.gameId&&null!=a&&((0,r.Xt)({id:e.id,channelId:a.id,gameId:e.gameId,broadcastTitle:e.broadcastTitle,language:e.language,tags:e.tags,classificationLabels:e.classificationLabels,isBrandedContent:e.isBrandedContent}),l({...S}),x("viewer"))},commmitLabel:"確定",onCancel:p})}):"viewer"===o?(0,s.jsxs)("div",{className:"p-10 h-fit flex flex-col gap-5",children:[(0,s.jsx)("h2",{className:"heading-2",children:"お気に入り"}),(0,s.jsx)("div",{className:"flex gap-y-7 gap-x-2 items-stretch flex-wrap",children:null==N?void 0:N.map(e=>{if(null!=e.id)return(0,s.jsx)("div",{className:"w-60 flex",children:(0,s.jsx)(E,{...e,onEdit:b,onApply:j,onDelete:g})},e.id)})}),(0,s.jsx)("h2",{className:"heading-2",children:"全件"}),(0,s.jsx)("div",{className:"flex gap-y-7 gap-x-2 items-stretch flex-wrap",children:null==v?void 0:v.map(e=>{if(null!=e.id)return(0,s.jsx)("div",{className:"w-60 flex",children:(0,s.jsx)(E,{...e,onEdit:b,onApply:j,onDelete:g})},e.id)})}),(0,s.jsx)("div",{className:"fixed bottom-0 right-0 w-20 h-20 mb-24 mr-10",children:(0,s.jsx)(d,{onClick:b})})]}):null}let S={broadcastTitle:"",language:"",tags:[],classificationLabels:[],isBrandedContent:!1,favorite:!1},_={title:"title",gameId:"gameId",language:"language",tags:"tags",classificationLabels:"classification-labels",isBrandedContents:"isBrandedContents"};function B(e){let l=(0,n.useRef)(e.value),a=(0,n.useCallback)(a=>{if(null!=e.onChange){switch(a.currentTarget.name){case _.title:l.current.broadcastTitle=a.currentTarget.value;break;case _.gameId:l.current.gameId=a.currentTarget.value;break;case _.language:l.current.language=a.currentTarget.value;break;case _.tags:l.current.tags=a.currentTarget.value.split(",").filter(e=>""!=e);break;case _.classificationLabels:if(a.currentTarget instanceof HTMLSelectElement)break;a.currentTarget.checked?l.current.classificationLabels.push(a.currentTarget.value):l.current.classificationLabels=l.current.classificationLabels.filter(e=>e!==a.currentTarget.value);break;case _.isBrandedContents:if(a.currentTarget instanceof HTMLSelectElement)break;l.current.isBrandedContent=a.currentTarget.checked}e.onChange(l.current)}},[e.onChange]);return(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"flex flex-col gap-5 py-4 px-10",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("p",{className:"w-48",children:"配信タイトル"}),(0,s.jsx)("input",{className:"input input-bordered w-full max-w-xs",type:"text",onChange:a,name:_.title,value:e.value.broadcastTitle})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("p",{className:"w-48",children:"配信ゲーム"}),(0,s.jsx)(T,{name:_.gameId,value:e.value.gameId,onChange:a})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("p",{className:"w-48",children:"配信言語"}),(0,s.jsxs)(v,{bordered:!0,name:_.language,onChange:a,children:[(0,s.jsx)("option",{disabled:!0,children:"選択言語"}),i.PK.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("p",{className:"w-48",children:"配信タグ"}),(0,s.jsx)(p,{value:e.value.tags.join(","),name:_.tags,onChange:a})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("p",{className:"w-48",children:"コンテンツ分類"}),(0,s.jsx)("div",{className:"flex flex-col gap-4",children:i.Ag.map(l=>(0,s.jsx)(j,{value:l.id,label:l.name,name:_.classificationLabels,color:"info",onChange:a,defaultChecked:e.value.classificationLabels.includes(l.id)},l.id))})]}),(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("p",{className:"w-48",children:"ブランドコンテンツ"}),(0,s.jsx)("div",{className:"flex flex-col gap-4",children:(0,s.jsx)("input",{type:"checkbox",className:"ios-toggle",name:_.isBrandedContents,defaultChecked:e.value.isBrandedContent,onChange:a})})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-end",children:[null!=e.onCancel?(0,s.jsx)("button",{className:"btn btn-warning",onClick:e.onCancel,children:null==e.canncelLabel?"キャンセル":e.canncelLabel}):null,(0,s.jsx)("button",{className:"btn btn-success",onClick:()=>{e.onCommit&&e.onCommit(l.current)},children:null==e.commmitLabel?"編集完了":e.commmitLabel})]})]})})}function M(){let e=(0,w.l)([]);return(0,s.jsx)("div",{className:"flex h-full grow perfect-scrollbar",ref:e.ref,children:(0,s.jsx)(L,{})})}},1789:function(e,l,a){"use strict";a.d(l,{GameContextProvider:function(){return c},j:function(){return t}});var s=a(9151);let n=(0,a(9813).a)({fetcher:s.m7,idKey:"id"}),t=n.useContext,c=n.Provider}},function(e){e.O(0,[22,76,802,140,971,23,744],function(){return e(e.s=9943)}),_N_E=e.O()}]);